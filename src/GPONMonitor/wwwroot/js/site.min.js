var OnuDescriptionListSearch=function(){"use strict";var n=$(".onu-list > tbody"),t=$("#search-input"),i=function(){$.event.special.inputchange={setup:function(){var n=this,t;$.data(this,"timer",window.setInterval(function(){t=n.value;$.data(n,"cache")!==t&&($.data(n,"cache",t),$(n).trigger("inputchange"))},1200))},teardown:function(){window.clearInterval($.data(this,"timer"))},add:function(){$.data(this,"cache",this.value)}};t.on("inputchange",function(){var u=$("#search-input").val().toLowerCase();if(u!==""){var r="",t="",i=u.split("_");i.length>=2?(r=i[0],t=i[1]):(r="",t=i[0]);n.find("tr.clickable-row").each(function(){~$(this).find("td.onu-list-id").text().toLowerCase().indexOf(r)&&(~$(this).find("td.onu-list-item").text().toLowerCase().indexOf(t)||~$(this).find("td.onu-list-sn > i").attr("title").toLowerCase().indexOf(t))?$(this).removeClass("d-none"):$(this).addClass("d-none")})}else n.find("tr.clickable-row").each(function(){$(this).removeClass("d-none")})})};return{init:i}}(),TooltipWhenOverflow=function(){"use strict";var n=function(){$(document).on("mouseenter",".onu-list-id, .onu-list-item, .onu-detail-description, .onu-detail-item",function(){var n=$(this);this.offsetWidth<this.scrollWidth?n.attr("title",n.text()):n.attr("title","")})};return{init:n}}(),NavbarMediaResize=function(){"use strict";var n=function(){function n(){$("body").css({paddingTop:$("#main-navbar").height()+15})}$(n);$(window).on("resize",n)};return{init:n}}(),OltDescriptionListService=function(){"use strict";var n=function(n,t,i){$.get("api/OltOnuDescriptionList",{oltId:n},"json").done(function(i){t(n,i)}).fail(function(t){i(n,t)})};return{getOltDescriptionList:n}}(),OnuDetailsService=function(){"use strict";var n=function(n,t,i,r,u){$.get("api/OnuStateByOltPortIdAndOnuId",{oltId:n,oltPortId:t,onuId:i},"json").done(function(u){r(n,t,i,u)}).fail(function(r){u(n,t,i,r)})};return{getOnuDetails:n}}(),OltDescriptionListController=function(n){"use strict";var i=$(".onu-list > tbody"),t=$("#refresh-onu-list"),r=$("#alert-indicator"),u=$("#alert-description"),c=$("#search-input"),l=function(){$(document).on("click",".js-get-onu-list:not(.disabled)",f);$(document).on("click","#refresh-onu-list:not(.disabled)",f)},a=function(i){s(i);t.addClass("disabled");t.addClass("fa-spin");n.getOltDescriptionList(i,e,o)},f=function(r){var u=$(r.target).attr("data-olt-id");s(u);t.addClass("disabled");t.addClass("fa-spin");i.empty();c.val("");n.getOltDescriptionList(u,e,o)},e=function(n,f){var e,l;r.addClass("d-none");u.empty();i.attr("data-olt-id",n);t.attr("data-olt-id",n);for(e in f){var o=f[e].oltPortId,s=f[e].onuId,p=f[e].onuGponSerialNumber,c;c=f[e].onuDescription!==""?f[e].onuDescription:"("+f[e].onuGponSerialNumber+")";l=f[e].onuOpticalConnectionState=="up"?"text-default":"text-danger";i.append("<tr class='clickable-row' data-olt-port-id='"+o+"' data-onu-id='"+s+"' data-href='#'><td class='onu-list-id'><span>"+o+"."+s+"<\/span><\/td><td class='onu-list-sn'><i class='fa fa-hdd "+l+"' title='"+p+"'><\/i><\/td><td class='onu-list-item'><span>"+c+"<\/span><\/td><\/tr>")}var w=0,a="",v=0,y="";i.find("tr.clickable-row").each(function(){var t=$(this).find("td.onu-list-id>span"),n=$(this).find("td.onu-list-item>span");t.outerWidth()>w&&(a=t.text());n.outerWidth()>v&&(v=n.outerWidth(),y=n.text())});i.append("<tr class='dummy-row invisible'><td class='onu-list-id'><span>"+a+"<\/span><\/td><td class='onu-list-sn'><i class='fa fa-hdd'><\/i><\/td><td class='onu-list-item'><span>"+y+"<\/span><\/td><\/tr>");t.removeClass("fa-spin");t.removeClass("disabled");h()},o=function(n,f){r.removeClass("d-none");u.text(f.responseText);i.attr("data-olt-id",n);t.attr("data-olt-id",n);t.removeClass("fa-spin");t.removeClass("disabled");h()},s=function(n){$("a.js-get-onu-list").removeClass("active");$("a.js-get-onu-list").removeClass("disabled");$(`a.js-get-onu-list[data-olt-id="${n}"]`).addClass("active");$(`a.js-get-onu-list[data-olt-id!="${n}"]`).addClass("disabled")},h=function(){$("a.js-get-onu-list").removeClass("disabled")};return{init:l,initializeOnuList:a}}(OltDescriptionListService),OnuDetailsController=function(n){"use strict";var r=$(".onu-list > tbody"),s=$(".onu-details > tbody"),i=$("#refresh-onu-details"),u=$("#alert-indicator"),f=$("#alert-description"),h=function(){r.on("click","tr.clickable-row",c);$(document).on("click","#refresh-onu-details",l)},c=function(t){var u=$(t.target),f=r.attr("data-olt-id"),s=u.closest("tr").attr("data-olt-port-id"),h=u.closest("tr").attr("data-onu-id");i.addClass("fa-spin");n.getOnuDetails(f,s,h,e,o)},l=function(){var t=i.attr("data-olt-id"),r=i.attr("data-olt-port-id"),u=i.attr("data-onu-id");(t==undefined||t=="")&&(t=0);(r==undefined||r=="")&&(r=0);(u==undefined||u=="")&&(u=0);i.addClass("fa-spin");n.getOnuDetails(t,r,u,e,o)},t=function(n){switch(n){case 0:return"indicator-unknown";case 1:return"indicator-default";case 2:return"indicator-info";case 3:return"indicator-success";case 4:return"indicator-warning";case 5:return"indicator-danger";default:return"indicator-unknown"}},e=function(n,r,e,o){var s,h,c,l,a;u.addClass("d-none");f.empty();$("#onu-olt-port-id-onu-id").text(o.oltPortId+"."+o.oltOnuId);s=o.descriptionName.description!==""?o.descriptionName.description:"("+o.gponSerialNumber.description+")";$("#onu-description").text(s);$("#onu-model-type").text(o.modelType.description);$("#onu-gpon-serial-number").text(o.gponSerialNumber.description);$("#onu-optical-connection-state").text(o.opticalConnectionState.description);$("#onu-optical-connection-state").attr("class","onu-detail-item").addClass(t(o.opticalConnectionState.severity));$("#onu-connection-deactivation-reason").text(o.opticalConnectionDeactivationReason.description);$("#onu-optical-power-received").text(o.opticalPowerReceived.description);$("#onu-optical-power-received").attr("class","onu-detail-item").addClass(t(o.opticalPowerReceived.severity));$("#onu-optical-cable-distance").text(o.opticalCableDistance.description);$("#onu-optical-connection-uptime").text(o.opticalConnectionUptime.description);$("#onu-system-uptime").text(o.systemUptime.description);$("#onu-connection-inactive-time").text(o.opticalConnectionInactiveTime.description);$("#onu-block-status").text(o.blockStatus.description);$("#onu-block-status").attr("class","onu-detail-item").addClass(t(o.blockStatus.severity));$("#onu-block-reason").text(o.blockReason.description);$("#onu-block-reason").attr("class","onu-detail-item").addClass(t(o.blockReason.severity));o.blockStatus.value!=="255"?$("#onu-block-reason").parent("tr").removeClass("d-none"):$("#onu-block-reason").parent("tr").addClass("d-none");$("#onu-firmware-version").text(o.firmwareVersion.description);$("#onu-gpon-profile").text(o.gponProfile.description);$("#onu-ip-host-1").empty();o.ipHost1.description.contains("0.0.0.0")||o.ipHost1.description.contains("NoSuchInstance")?$("#onu-ip-host-1").parent("tr").addClass("d-none"):($("#onu-ip-host-1").parent("tr").removeClass("d-none"),$("#onu-ip-host-1").append("<a href=http://"+o.ipHost1.description+' target="_blank" rel="noopener noreferrer">'+o.ipHost1.description+"<\/a>"));o.hasOwnProperty("ethernetPort1State")&&o.hasOwnProperty("ethernetPort1Speed")?(h=o.ethernetPort1State.value===1?o.ethernetPort1State.description+" - "+o.ethernetPort1Speed.description:o.ethernetPort1State.description,$("#onu-ethernet-port-1-state-and-speed").text(h).parent("tr").removeClass("d-none"),$("#onu-ethernet-port-1-state-and-speed").attr("class","onu-detail-item").addClass(t(o.ethernetPort1State.severity))):($("#onu-ethernet-port-1-state-and-speed").empty().parent("tr").addClass("d-none"),$("#onu-ethernet-port-1-state-and-speed").attr("class","onu-detail-item"));o.hasOwnProperty("ethernetPort2State")&&o.hasOwnProperty("ethernetPort2Speed")?(c=o.ethernetPort2State.value===1?o.ethernetPort2State.description+" - "+o.ethernetPort2Speed.description:o.ethernetPort2State.description,$("#onu-ethernet-port-2-state-and-speed").text(c).parent("tr").removeClass("d-none"),$("#onu-ethernet-port-2-state-and-speed").attr("class","onu-detail-item").addClass(t(o.ethernetPort2State.severity))):($("#onu-ethernet-port-2-state-and-speed").empty().parent("tr").addClass("d-none"),$("#onu-ethernet-port-2-state-and-speed").attr("class","onu-detail-item"));o.hasOwnProperty("ethernetPort3State")&&o.hasOwnProperty("ethernetPort3Speed")?(l=o.ethernetPort3State.value===1?o.ethernetPort3State.description+" - "+o.ethernetPort3Speed.description:o.ethernetPort3State.description,$("#onu-ethernet-port-3-state-and-speed").text(l).parent("tr").removeClass("d-none"),$("#onu-ethernet-port-3-state-and-speed").attr("class","onu-detail-item").addClass(t(o.ethernetPort3State.severity))):($("#onu-ethernet-port-3-state-and-speed").empty().parent("tr").addClass("d-none"),$("#onu-ethernet-port-3-state-and-speed").attr("class","onu-detail-item"));o.hasOwnProperty("ethernetPort4State")&&o.hasOwnProperty("ethernetPort4Speed")?(a=o.ethernetPort4State.value===1?o.ethernetPort4State.description+" - "+o.ethernetPort4Speed.description:o.ethernetPort4State.description,$("#onu-ethernet-port-4-state-and-speed").text(a).parent("tr").removeClass("d-none"),$("#onu-ethernet-port-4-state-and-speed").attr("class","onu-detail-item").addClass(t(o.ethernetPort4State.severity))):($("#onu-ethernet-port-4-state-and-speed").empty().parent("tr").addClass("d-none"),$("#onu-ethernet-port-4-state-and-speed").attr("class","onu-detail-item"));o.hasOwnProperty("voIPLine1State")?($("#onu-voip-port-1-state").text(o.voIPLine1State.description).parent("tr").removeClass("d-none"),$("#onu-voip-port-1-state").attr("class","onu-detail-item").addClass(t(o.voIPLine1State.severity))):($("#onu-voip-port-1-state").empty().parent("tr").addClass("d-none"),$("#onu-voip-port-1-state").attr("class","onu-detail-item"));o.hasOwnProperty("voIPLine2State")?($("#onu-voip-port-2-state").text(o.voIPLine2State.description).parent("tr").removeClass("d-none"),$("#onu-voip-port-2-state").attr("class","onu-detail-item").addClass(t(o.voIPLine2State.severity))):($("#onu-voip-port-2-state").empty().parent("tr").addClass("d-none"),$("#onu-voip-port-2-state").attr("class","onu-detail-item"));o.modelType.description!==""?$("#onu-image").attr("src","images/ONU/"+o.modelType.description+".png").on("error",function(){$(this).hide()}).parents().eq(2).removeClass("d-none"):$("#onu-image").parents().eq(2).addClass("d-none");i.attr("data-olt-id",n).attr("data-olt-port-id",r).attr("data-onu-id",e);i.removeClass("fa-spin")},o=function(n,t,r,e){u.removeClass("d-none");f.text(e.responseText);s.find("tr > td.onu-detail-item").empty();$("#onu-image").parents().eq(2).addClass("d-none");i.attr("data-olt-id",n).attr("data-olt-port-id",t).attr("data-onu-id",r);i.removeClass("fa-spin")};return{init:h}}(OnuDetailsService);